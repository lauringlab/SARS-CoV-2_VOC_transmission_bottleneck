

# ====== Import Things ======
import os
import pandas as pd
from Bio import SeqIO
from Bio.Seq import Seq
from Bio.SeqRecord import SeqRecord


# ================================ Main =========================================

consensus = "../Results/consensus_for_sample_pairs_aligned.fasta"
sites =  (29708, 3259, 7214, 12578, 15168, 16508, 19679, 22899, 29035, 6352, 6470, 29440, 22009, 1059, 1927, 5388, 6559, 7098, 8986, 10230, 11961, 12018, 12085, 12650, 13020, 13257, 14116, 15221, 16311, 17498, 18423, 21912, 22917, 22995, 23063, 23685, 26774, 26894, 3083, 17875, 22941, 2258, 3929, 12094, 16700, 5759, 18267, 7113, 11020, 25792, 27416, 29467, 1960, 17392, 18508, 27661, 28079, 23123, 14484, 1684, 24046, 25710, 26256, 10852, 13665, 6401, 7904, 11962, 24999, 28201, 14448, 4708, 12025, 18907, 20469, 21114, 7279, 8825, 17550, 29769, 5770, 22104, 23902, 25003, 24793, 24794, 27688, 9757, 8964, 20751, 23522, 23604, 25227, 3287, 15172, 17746, 27671, 500, 1347, 18877, 22997, 25818, 29751, 12847, 29034, 291, 28131, 28132, 28881, 12076, 63, 210, 498, 527, 858, 1214, 2523, 2548, 3232, 3326, 3695, 4080, 4263, 5386, 5697, 8480, 10010, 10029, 10272, 10507, 10560, 11114, 11150, 11201, 11881, 12424, 12489, 12811, 12967, 13681, 13758, 14803, 15042, 15153, 16022, 16466, 16617, 17459, 17507, 17547, 17649, 17650, 19570, 20105, 20235, 21797, 22170, 22432, 22514, 22673, 23374, 23451, 23673, 25083, 25278, 25354, 26919, 23634, 1124, 13743, 27213, 3611, 11633, 27230, 2881, 9301, 13038, 22763, 17676, 4905, 9070, 17261, 10889, 27522, 196, 27536, 10798, 15346, 28936, 3077, 7860, 14094, 21736, 11768, 2062, 18417, 5555, 12251, 9848, 9737, 28809, 6372, 28657, 12628, 29224, 27376, 27383, 805, 11750, 29185, 420, 24724, 22528, 2448, 25452, 1878, 16332, 884, 4230, 10802, 24579, 5025, 6556, 10135, 11758, 17799, 21595, 22599, 25708, 27244, 15654, 20799, 27619, 29022, 19476)
f = open("Results/consensus_allele_forsnv_sites.txt", "a")
header = "sample Allele POS"
f.write (header + '\n')

for record in SeqIO.parse(consensus, "fasta"):
    for site in sites:
         bp=(record.id, record.seq[site-1], site)
         f.write (' '.join(str(s) for s in bp) + '\n')
f.close ()    
